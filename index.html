<script>
    async function salvarNomeEEnviar() {
        var nomeUsuario = document.getElementById("nome").value;

        if (nomeUsuario.trim() === "") {
            alert("Por favor, insira seu nome antes de prosseguir.");
            return;
        }

        try {
            // Obter dados existentes do JSON no repositório central
            var response = await fetch('https://raw.githubusercontent.com/Lusca-LJ12/Nomes-Salvos/main/dados.json');
            var dadosExistente = await response.json() || [];

            // Adicionar novo nome à lista
            dadosExistente.push({ nome: nomeUsuario, dataHora: new Date().toLocaleString() });

            // Salvar dados atualizados no JSON no repositório central
            await fetch('https://api.github.com/repos/Lusca-LJ12/Nomes-Salvos/contents/dados.json', {
                method: 'PUT',
                headers: {
                    'Authorization': 'Bearer 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',
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: 'Adicionando novo nome',
                    content: btoa(JSON.stringify(dadosExistente)),
                    sha: response.headers.get('etag'),
                }),
            });

            // Redirecionar o usuário para comoesta.html
            window.location.href = 'comoesta.html';
        } catch (error) {
            console.error('Erro ao salvar nome:', error);
            alert('Erro ao salvar nome. Por favor, tente novamente.');
        }
    }
</script>
